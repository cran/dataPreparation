<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />


<meta name="date" content="2020-11-13" />

<title>Tutorial: discovering dataPreparation functionalities</title>

<link href="data:text/css;charset=utf-8,%0Aa%2Eanchor%2Dsection%20%7Bmargin%2Dleft%3A%2010px%3B%20visibility%3A%20hidden%3B%20color%3A%20inherit%3B%7D%0Aa%2Eanchor%2Dsection%3A%3Abefore%20%7Bcontent%3A%20%27%23%27%3B%7D%0A%2EhasAnchor%3Ahover%20a%2Eanchor%2Dsection%20%7Bvisibility%3A%20visible%3B%7D%0A" rel="stylesheet" />
<script src="data:application/x-javascript;base64,Ly8gQW5jaG9yIHNlY3Rpb25zIHYxLjAgd3JpdHRlbiBieSBBdHN1c2hpIFlhc3Vtb3RvIG9uIE9jdCAzcmQsIDIwMjAuCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHsKICAvLyBEbyBub3RoaW5nIGlmIEFuY2hvckpTIGlzIHVzZWQKICBpZiAodHlwZW9mIHdpbmRvdy5hbmNob3JzID09PSAnb2JqZWN0JyAmJiBhbmNob3JzLmhhc093blByb3BlcnR5KCdoYXNBbmNob3JKU0xpbmsnKSkgewogICAgcmV0dXJuOwogIH0KCiAgY29uc3QgaCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2gxLCBoMiwgaDMsIGg0LCBoNSwgaDYnKTsKCiAgLy8gRG8gbm90aGluZyBpZiBzZWN0aW9ucyBhcmUgYWxyZWFkeSBhbmNob3JlZAogIGlmIChBcnJheS5mcm9tKGgpLnNvbWUoeCA9PiB4LmNsYXNzTGlzdC5jb250YWlucygnaGFzQW5jaG9yJykpKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIC8vIFVzZSBzZWN0aW9uIGlkIHdoZW4gcGFuZG9jIHJ1bnMgd2l0aCAtLXNlY3Rpb24tZGl2cwogIGNvbnN0IHNlY3Rpb25faWQgPSBmdW5jdGlvbih4KSB7CiAgICByZXR1cm4gKCh4LmNsYXNzTGlzdC5jb250YWlucygnc2VjdGlvbicpIHx8ICh4LnRhZ05hbWUgPT09ICdTRUNUSU9OJykpCiAgICAgICAgICAgID8geC5pZCA6ICcnKTsKICB9OwoKICAvLyBBZGQgYW5jaG9ycwogIGguZm9yRWFjaChmdW5jdGlvbih4KSB7CiAgICBjb25zdCBpZCA9IHguaWQgfHwgc2VjdGlvbl9pZCh4LnBhcmVudEVsZW1lbnQpOwogICAgaWYgKGlkID09PSAnJykgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIGxldCBhbmNob3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICBhbmNob3IuaHJlZiA9ICcjJyArIGlkOwogICAgYW5jaG9yLmNsYXNzTGlzdCA9IFsnYW5jaG9yLXNlY3Rpb24nXTsKICAgIHguY2xhc3NMaXN0LmFkZCgnaGFzQW5jaG9yJyk7CiAgICB4LmFwcGVuZENoaWxkKGFuY2hvcik7CiAgfSk7Cn0pOwo="></script>
<script src="data:application/x-javascript;base64,JChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXsKICAgIGlmICh0eXBlb2YgJCgnW2RhdGEtdG9nZ2xlPSJ0b29sdGlwIl0nKS50b29sdGlwID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgJCgnW2RhdGEtdG9nZ2xlPSJ0b29sdGlwIl0nKS50b29sdGlwKCk7CiAgICB9CiAgICBpZiAoJCgnW2RhdGEtdG9nZ2xlPSJwb3BvdmVyIl0nKS5wb3BvdmVyID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgJCgnW2RhdGEtdG9nZ2xlPSJwb3BvdmVyIl0nKS5wb3BvdmVyKCk7CiAgICB9Cn0pOwo="></script>
<link href="data:text/css;charset=utf-8,%0A%2Elightable%2Dminimal%20%7B%0Aborder%2Dcollapse%3A%20separate%3B%0Aborder%2Dspacing%3A%2016px%201px%3B%0Awidth%3A%20100%25%3B%0Amargin%2Dbottom%3A%2010px%3B%0A%7D%0A%2Elightable%2Dminimal%20td%20%7B%0Amargin%2Dleft%3A%205px%3B%0Amargin%2Dright%3A%205px%3B%0A%7D%0A%2Elightable%2Dminimal%20th%20%7B%0Amargin%2Dleft%3A%205px%3B%0Amargin%2Dright%3A%205px%3B%0A%7D%0A%2Elightable%2Dminimal%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%2300000050%3B%0Aempty%2Dcells%3A%20hide%3B%0A%7D%0A%2Elightable%2Dminimal%20tbody%20tr%3Afirst%2Dchild%20td%20%7B%0Apadding%2Dtop%3A%200%2E5em%3B%0A%7D%0A%2Elightable%2Dminimal%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dminimal%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dclassic%20%7B%0Aborder%2Dtop%3A%200%2E16em%20solid%20%23111111%3B%0Aborder%2Dbottom%3A%200%2E16em%20solid%20%23111111%3B%0Awidth%3A%20100%25%3B%0Amargin%2Dbottom%3A%2010px%3B%0Amargin%3A%2010px%205px%3B%0A%7D%0A%2Elightable%2Dclassic%20tfoot%20tr%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dclassic%20tfoot%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%200%2E14em%20solid%20%23111111%3B%0A%7D%0A%2Elightable%2Dclassic%20caption%20%7B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%20td%20%7B%0Apadding%2Dleft%3A%205px%3B%0Apadding%2Dright%3A%205px%3B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%20th%20%7B%0Apadding%2Dleft%3A%205px%3B%0Apadding%2Dright%3A%205px%3B%0Afont%2Dweight%3A%20normal%3B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Aborder%2Dbottom%3A%200%2E10em%20solid%20%23111111%3B%0A%7D%0A%2Elightable%2Dclassic%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23F9EEC1%3B%0A%7D%0A%2Elightable%2Dclassic%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20%7B%0Aborder%2Dtop%3A%203px%20double%20%23111111%3B%0Aborder%2Dbottom%3A%203px%20double%20%23111111%3B%0Awidth%3A%20100%25%3B%0Amargin%2Dbottom%3A%2010px%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20tfoot%20tr%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20tfoot%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%203px%20double%20%23111111%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20caption%20%7B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20td%20%7B%0Apadding%2Dleft%3A%205px%3B%0Apadding%2Dright%3A%205px%3B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20th%20%7B%0Apadding%2Dleft%3A%205px%3B%0Apadding%2Dright%3A%205px%3B%0Afont%2Dweight%3A%20normal%3B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20tbody%20tr%3Alast%2Dchild%20td%20%7B%0Aborder%2Dbottom%3A%203px%20double%20%23111111%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23111111%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23F9EEC1%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dmaterial%20%7B%0Amin%2Dwidth%3A%20100%25%3B%0Awhite%2Dspace%3A%20nowrap%3B%0Atable%2Dlayout%3A%20fixed%3B%0Afont%2Dfamily%3A%20Roboto%2C%20sans%2Dserif%3B%0Aborder%3A%201px%20solid%20%23EEE%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0Amargin%2Dbottom%3A%2010px%3B%0A%7D%0A%2Elightable%2Dmaterial%20tfoot%20tr%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dmaterial%20tfoot%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%201px%20solid%20%23EEE%3B%0A%7D%0A%2Elightable%2Dmaterial%20th%20%7B%0Aheight%3A%2056px%3B%0Apadding%2Dleft%3A%2016px%3B%0Apadding%2Dright%3A%2016px%3B%0A%7D%0A%2Elightable%2Dmaterial%20td%20%7B%0Aheight%3A%2052px%3B%0Apadding%2Dleft%3A%2016px%3B%0Apadding%2Dright%3A%2016px%3B%0Aborder%2Dtop%3A%201px%20solid%20%23eeeeee%3B%0A%7D%0A%2Elightable%2Dmaterial%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dmaterial%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dmaterial%2Elightable%2Dstriped%20tbody%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dmaterial%2Elightable%2Dstriped%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ddd%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%20%7B%0Amin%2Dwidth%3A%20100%25%3B%0Awhite%2Dspace%3A%20nowrap%3B%0Atable%2Dlayout%3A%20fixed%3B%0Afont%2Dfamily%3A%20Roboto%2C%20sans%2Dserif%3B%0Aborder%3A%201px%20solid%20%23FFFFFF12%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0Amargin%2Dbottom%3A%2010px%3B%0Abackground%2Dcolor%3A%20%23363640%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%20tfoot%20tr%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%20tfoot%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%201px%20solid%20%23FFFFFF12%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%20th%20%7B%0Aheight%3A%2056px%3B%0Apadding%2Dleft%3A%2016px%3B%0Apadding%2Dright%3A%2016px%3B%0Acolor%3A%20%23FFFFFF60%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%20td%20%7B%0Aheight%3A%2052px%3B%0Apadding%2Dleft%3A%2016px%3B%0Apadding%2Dright%3A%2016px%3B%0Acolor%3A%20%23FFFFFF%3B%0Aborder%2Dtop%3A%201px%20solid%20%23FFFFFF12%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF12%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF12%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%2Elightable%2Dstriped%20tbody%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%2Elightable%2Dstriped%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23FFFFFF12%3B%0A%7D%0A%2Elightable%2Dpaper%20%7B%0Awidth%3A%20100%25%3B%0Amargin%2Dbottom%3A%2010px%3B%0Acolor%3A%20%23444%3B%0A%7D%0A%2Elightable%2Dpaper%20tfoot%20tr%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dpaper%20tfoot%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%201px%20solid%20%2300000020%3B%0A%7D%0A%2Elightable%2Dpaper%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Acolor%3A%20%23666%3B%0Avertical%2Dalign%3A%20bottom%3B%0Aborder%2Dbottom%3A%201px%20solid%20%2300000020%3B%0Aline%2Dheight%3A%201%2E15em%3B%0Apadding%3A%2010px%205px%3B%0A%7D%0A%2Elightable%2Dpaper%20td%20%7B%0Avertical%2Dalign%3A%20middle%3B%0Aborder%2Dbottom%3A%201px%20solid%20%2300000010%3B%0Aline%2Dheight%3A%201%2E15em%3B%0Apadding%3A%207px%205px%3B%0A%7D%0A%2Elightable%2Dpaper%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23F9EEC1%3B%0A%7D%0A%2Elightable%2Dpaper%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%2300000008%3B%0A%7D%0A%2Elightable%2Dpaper%2Elightable%2Dstriped%20tbody%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Tutorial: discovering dataPreparation functionalities</h1>
<h4 class="date">2020-11-13</h4>



<p>This vignette introduces <em>dataPreparation</em> package (v1.0.0), what it offers, how simple it is to use it.</p>
<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<div id="package-presentation" class="section level2">
<h2><span class="header-section-number">1.1</span> Package presentation</h2>
<p>Based on <a href="https://rdatatable.gitlab.io/data.table/">data.table</a> package, <strong>dataPreparation</strong> will allow you to do most of the painful data preparation for a data science project with a minimum amount of code.</p>
<p>This package is</p>
<ul>
<li>fast (use <code>data.table</code> and exponential search)</li>
<li>RAM efficient (perform operations by reference and column-wise to avoid copying data)</li>
<li>stable (most exceptions are handled)</li>
<li>verbose (log a lot)</li>
</ul>
<p><code>data.table</code> and other dependencies are handled at installation.</p>
</div>
<div id="main-preparation-steps" class="section level2">
<h2><span class="header-section-number">1.2</span> Main preparation steps</h2>
<p>Before using any machine learning (ML) algorithm, one needs to prepare its data. Preparing a data set for a data science project can be long and tricky. The main steps are the followings:</p>
<ul>
<li><strong>Read</strong>: load the data set (this package don't treat this point: for csv we recommend <code>data.table::fread</code>)</li>
<li><strong>Correct</strong>: most of the times, there are some mistake after reading, wrong format... one have to correct them</li>
<li><strong>Transform</strong>: creating new features from date, categorical, character... in order to have information usable for a ML algorithm (aka: numeric or categorical)</li>
<li><strong>Filter</strong>: get rid of useless information in order to speed up computation</li>
<li><strong>Handle NA</strong>: replace missing values</li>
<li><strong>Pre model transformation</strong>: Specific manipulation for the chosen model (handling NA, discretization, one hot encoding, scaling...)</li>
<li><strong>Shape</strong>: put your data set in a nice shape usable by a ML algorithm</li>
</ul>
<p>Here are the functions available in this package to tackle those issues:</p>
<table style="width:94%;">
<colgroup>
<col width="13%"></col>
<col width="16%"></col>
<col width="12%"></col>
<col width="16%"></col>
<col width="34%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Correct</th>
<th>Transform</th>
<th>Filter</th>
<th>Pre model manipulation</th>
<th>Shape</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>un_factor</td>
<td>generate_date_diffs</td>
<td>fast_filter_variables</td>
<td>fast_handle_na</td>
<td>shape_set</td>
</tr>
<tr class="even">
<td>find_and_transform_dates</td>
<td>generate_factor_from_date</td>
<td>which_are_constant</td>
<td>fast_discretization</td>
<td>same_shape</td>
</tr>
<tr class="odd">
<td>find_and_transform_numerics</td>
<td>aggregate_by_key</td>
<td>which_are_in_double</td>
<td>fast_scale</td>
<td>set_as_numeric_matrix</td>
</tr>
<tr class="even">
<td>set_col_as_character</td>
<td>generate_from_factor</td>
<td>which_are_bijection</td>
<td></td>
<td>one_hot_encoder</td>
</tr>
<tr class="odd">
<td>set_col_as_numeric</td>
<td>generate_from_character</td>
<td>remove_sd_outlier</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>set_col_as_date</td>
<td>fast_round</td>
<td>remove_rare_categorical</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>set_col_as_factor</td>
<td>target_encode</td>
<td>remove_percentile_outlier</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>All of those functions are integrated in the <strong>full pipeline</strong> function <code>prepare_set</code>.</p>
<p>In this tutorial we will detail all those steps and how to treat them with this package using an example data set.</p>
</div>
<div id="tutorial-data" class="section level2">
<h2><span class="header-section-number">1.3</span> Tutorial data</h2>
<p>For this tutorial, we are going to use a <em>messy</em> version of <a href="https://archive.ics.uci.edu/ml/datasets/adult">adult</a> data base.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(messy_adult)
<span class="kw">print</span>(<span class="kw">head</span>(messy_adult, <span class="dt">n =</span> <span class="dv">4</span>))</code></pre></div>
<pre><code>#        date1      date2        date3              date4    num1   num2 constant
# 1:      &lt;NA&gt; 1510441200  24-Mar-2017     26-march, 2017  1.9309 0,0864        1
# 2: 2017-26-9 1490482800  01-Feb-2017  03-february, 2017 -0.4273 0,6345        1
# 3:      &lt;NA&gt; 1510614000  18-Sep-2017 20-september, 2017  0.6093 1,8958        1
# 4:  2017-6-1         NA  25-Jun-2017      27-june, 2017 -0.5138 0,4505        1
#                                mail    num3 age    type_employer fnlwgt
# 1:          pierre.caroline@aol.com  1,9309  39        State-gov  77516
# 2:           pierre.lucas@yahoo.com -0,4273  50 Self-emp-not-inc  83311
# 3: caroline.caroline@protonmail.com  0,6093  38          Private 215646
# 4:         marie.caroline@gmail.com -0,5138  53          Private 234721
#    education education_num            marital        occupation  relationship
# 1: Bachelors            13      Never-married      Adm-clerical Not-in-family
# 2: Bachelors            13 Married-civ-spouse   Exec-managerial       Husband
# 3:   HS-grad             9           Divorced Handlers-cleaners Not-in-family
# 4:      11th             7 Married-civ-spouse Handlers-cleaners       Husband
#     race  sex capital_gain capital_loss hr_per_week       country income
# 1: White Male         2174            0          40 United-States  &lt;=50K
# 2: White Male            0            0          13 United-States  &lt;=50K
# 3: White Male            0            0          40 United-States  &lt;=50K
# 4: Black Male            0            0          40 United-States  &lt;=50K</code></pre>
<p>We added 9 really ugly columns to the data set:</p>
<ul>
<li>4 dates with various formats, or time stamps, and NAs</li>
<li>1 constant column</li>
<li>3 numeric with different decimal separator</li>
<li>1 email address</li>
</ul>
<p>There are some columns that contains the same information with different repr√©sentation (ex: education and eduction_num).</p>
</div>
</div>
<div id="correct-functions" class="section level1">
<h1><span class="header-section-number">2</span> <em>Correct</em> functions</h1>
<div id="identifying-factor-that-shouldnt-be" class="section level2">
<h2><span class="header-section-number">2.1</span> Identifying factor that shouldn't be</h2>
<p>It often happens when reading a data set that R put string into a factor even if it shouldn't be. In this tutorial data set, <code>mail</code> is a factor but shouldn't be. It will automatically be detected using <code>un_factor</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">class</span>(messy_adult<span class="op">$</span>mail))</code></pre></div>
<pre><code># &quot;factor&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">messy_adult &lt;-<span class="st"> </span><span class="kw">un_factor</span>(messy_adult)</code></pre></div>
<pre><code># &quot;date1&quot;         &quot;date2&quot;         &quot;date3&quot;         &quot;date4&quot;        
# &quot;num1&quot;          &quot;num2&quot;          &quot;constant&quot;      &quot;num3&quot;         
# &quot;age&quot;           &quot;fnlwgt&quot;        &quot;education_num&quot; &quot;capital_gain&quot; 
# &quot;capital_loss&quot;  &quot;hr_per_week&quot;  
# [1] &quot;un_factor: c(\&quot;date1\&quot;, \&quot;date2\&quot;, \&quot;date3\&quot;, \&quot;date4\&quot;, \&quot;num1\&quot;, \&quot;num2\&quot;, \&quot;constant\&quot;, \&quot;num3\&quot;, \&quot;age\&quot;, \&quot;fnlwgt\&quot;, \&quot;education_num\&quot;, \&quot;capital_gain\&quot;, \&quot;capital_loss\&quot;, \&quot;hr_per_week\&quot;) aren't columns of types factor i do nothing for those variables.&quot;
# [1] &quot;un_factor: I will identify variable that are factor but shouldn't be.&quot;
# [1] &quot;un_factor: I unfactor mail.&quot;
# [1] &quot;un_factor: It took me 0s to unfactor 1 column(s).&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">class</span>(messy_adult<span class="op">$</span>mail))</code></pre></div>
<pre><code># &quot;character&quot;</code></pre>
</div>
<div id="identifing-and-transforming-date-columns" class="section level2">
<h2><span class="header-section-number">2.2</span> Identifing and transforming date columns</h2>
<p>The next thing to do is to <strong>identify</strong> columns that are dates (the first 4 ones) and <strong>transform</strong> them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">messy_adult &lt;-<span class="st"> </span><span class="kw">find_and_transform_dates</span>(messy_adult)</code></pre></div>
<pre><code># &quot;find_and_transform_dates: It took me 0.7s to identify formats&quot;
# &quot;find_and_transform_dates: It took me 0.08s to transform 4 columns to a Date format.&quot;</code></pre>
Let's have a look to the transformation performed on those 4 columns:
<table class="table table-striped table-hover" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
date1_prev
</th>
<th style="text-align:right;">
date2_prev
</th>
<th style="text-align:left;">
date3_prev
</th>
<th style="text-align:left;">
date4_prev
</th>
<th style="text-align:left;">
transfo
</th>
<th style="text-align:left;">
date1
</th>
<th style="text-align:left;">
date2
</th>
<th style="text-align:left;">
date3
</th>
<th style="text-align:left;">
date4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1510441200
</td>
<td style="text-align:left;">
24-Mar-2017
</td>
<td style="text-align:left;">
26-march, 2017
</td>
<td style="text-align:left;">
=&gt;
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2017-11-12 00:00:00
</td>
<td style="text-align:left;">
2017-03-24
</td>
<td style="text-align:left;">
2017-03-26
</td>
</tr>
<tr>
<td style="text-align:left;">
2017-26-9
</td>
<td style="text-align:right;">
1490482800
</td>
<td style="text-align:left;">
01-Feb-2017
</td>
<td style="text-align:left;">
03-february, 2017
</td>
<td style="text-align:left;">
=&gt;
</td>
<td style="text-align:left;">
2017-09-26
</td>
<td style="text-align:left;">
2017-03-26 00:00:00
</td>
<td style="text-align:left;">
2017-02-01
</td>
<td style="text-align:left;">
2017-02-03
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1510614000
</td>
<td style="text-align:left;">
18-Sep-2017
</td>
<td style="text-align:left;">
20-september, 2017
</td>
<td style="text-align:left;">
=&gt;
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2017-11-14 00:00:00
</td>
<td style="text-align:left;">
2017-09-18
</td>
<td style="text-align:left;">
2017-09-20
</td>
</tr>
<tr>
<td style="text-align:left;">
2017-6-1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
25-Jun-2017
</td>
<td style="text-align:left;">
27-june, 2017
</td>
<td style="text-align:left;">
=&gt;
</td>
<td style="text-align:left;">
2017-01-06
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2017-06-25
</td>
<td style="text-align:left;">
2017-06-27
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1494457200
</td>
<td style="text-align:left;">
26-Jan-2017
</td>
<td style="text-align:left;">
28-january, 2017
</td>
<td style="text-align:left;">
=&gt;
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2017-05-11 01:00:00
</td>
<td style="text-align:left;">
2017-01-26
</td>
<td style="text-align:left;">
2017-01-28
</td>
</tr>
<tr>
<td style="text-align:left;">
2017-18-7
</td>
<td style="text-align:right;">
1494370800
</td>
<td style="text-align:left;">
04-Apr-2017
</td>
<td style="text-align:left;">
06-april, 2017
</td>
<td style="text-align:left;">
=&gt;
</td>
<td style="text-align:left;">
2017-07-18
</td>
<td style="text-align:left;">
2017-05-10 01:00:00
</td>
<td style="text-align:left;">
2017-04-04
</td>
<td style="text-align:left;">
2017-04-06
</td>
</tr>
</tbody>
</table>
<p>As one can see, even if formats were different and somehow ugly, they were all handled.</p>
</div>
<div id="identifying-and-transforming-numeric-columns" class="section level2">
<h2><span class="header-section-number">2.3</span> Identifying and transforming numeric columns</h2>
<p>And now the same thing with numeric</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">messy_adult &lt;-<span class="st"> </span><span class="kw">find_and_transform_numerics</span>(messy_adult)</code></pre></div>
<pre><code># &quot;find_and_transform_numerics: It took me 0s to identify 3 numerics column(s), i will set them as numerics&quot;
# &quot;set_col_as_numeric: I will set some columns as numeric&quot;
# &quot;set_col_as_numeric: I am doing the column num1.&quot;
# &quot;set_col_as_numeric: 0 NA have been created due to transformation to numeric.&quot;
# &quot;set_col_as_numeric: I will set some columns as numeric&quot;
# &quot;set_col_as_numeric: I am doing the column num2.&quot;
# &quot;set_col_as_numeric: 0 NA have been created due to transformation to numeric.&quot;
# &quot;set_col_as_numeric: I am doing the column num3.&quot;
# &quot;set_col_as_numeric: 0 NA have been created due to transformation to numeric.&quot;
# &quot;find_and_transform_numerics: It took me 0.05s to transform 3 column(s) to a numeric format.&quot;</code></pre>
<table class="table table-striped table-hover" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
num1_prev
</th>
<th style="text-align:left;">
num2_prev
</th>
<th style="text-align:left;">
num3_prev
</th>
<th style="text-align:left;">
transfo
</th>
<th style="text-align:right;">
num1
</th>
<th style="text-align:right;">
num2
</th>
<th style="text-align:right;">
num3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1.9309
</td>
<td style="text-align:left;">
0,0864
</td>
<td style="text-align:left;">
1,9309
</td>
<td style="text-align:left;">
=&gt;
</td>
<td style="text-align:right;">
1.9309
</td>
<td style="text-align:right;">
0.0864
</td>
<td style="text-align:right;">
1.9309
</td>
</tr>
<tr>
<td style="text-align:left;">
-0.4273
</td>
<td style="text-align:left;">
0,6345
</td>
<td style="text-align:left;">
-0,4273
</td>
<td style="text-align:left;">
=&gt;
</td>
<td style="text-align:right;">
-0.4273
</td>
<td style="text-align:right;">
0.6345
</td>
<td style="text-align:right;">
-0.4273
</td>
</tr>
<tr>
<td style="text-align:left;">
0.6093
</td>
<td style="text-align:left;">
1,8958
</td>
<td style="text-align:left;">
0,6093
</td>
<td style="text-align:left;">
=&gt;
</td>
<td style="text-align:right;">
0.6093
</td>
<td style="text-align:right;">
1.8958
</td>
<td style="text-align:right;">
0.6093
</td>
</tr>
<tr>
<td style="text-align:left;">
-0.5138
</td>
<td style="text-align:left;">
0,4505
</td>
<td style="text-align:left;">
-0,5138
</td>
<td style="text-align:left;">
=&gt;
</td>
<td style="text-align:right;">
-0.5138
</td>
<td style="text-align:right;">
0.4505
</td>
<td style="text-align:right;">
-0.5138
</td>
</tr>
<tr>
<td style="text-align:left;">
1.0563
</td>
<td style="text-align:left;">
1,342
</td>
<td style="text-align:left;">
1,0563
</td>
<td style="text-align:left;">
=&gt;
</td>
<td style="text-align:right;">
1.0563
</td>
<td style="text-align:right;">
1.3420
</td>
<td style="text-align:right;">
1.0563
</td>
</tr>
<tr>
<td style="text-align:left;">
-0.9377
</td>
<td style="text-align:left;">
-0,0421
</td>
<td style="text-align:left;">
-0,9377
</td>
<td style="text-align:left;">
=&gt;
</td>
<td style="text-align:right;">
-0.9377
</td>
<td style="text-align:right;">
-0.0421
</td>
<td style="text-align:right;">
-0.9377
</td>
</tr>
</tbody>
</table>
<p>So now our data set is a bit less ugly.</p>
</div>
</div>
<div id="filter-functions" class="section level1">
<h1><span class="header-section-number">3</span> <em>Filter</em> functions</h1>
<p>The idea now is to identify useless columns:</p>
<ul>
<li><em>constant</em> columns: they take the same value for every line,</li>
<li><em>double</em> columns: they have an exact copy in the data set,</li>
<li><em>bijection</em> columns: there is another column containing the exact same information (but maybe coded differently) for example col1: Men/Women, col2 M/W.</li>
</ul>
<div id="look-for-constant-variables" class="section level2">
<h2><span class="header-section-number">3.1</span> Look for constant variables</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">constant_cols &lt;-<span class="st"> </span><span class="kw">which_are_constant</span>(messy_adult)</code></pre></div>
<pre><code># &quot;which_are_constant: constant is constant.&quot;
# &quot;which_are_constant: it took me 0s to identify 1 constant column(s)&quot;</code></pre>
</div>
<div id="look-for-columns-in-double" class="section level2">
<h2><span class="header-section-number">3.2</span> Look for columns in double</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">double_cols &lt;-<span class="st"> </span><span class="kw">which_are_in_double</span>(messy_adult)</code></pre></div>
<pre><code># &quot;which_are_in_double: it took me 0s to identify 1 column(s) to drop.&quot;</code></pre>
</div>
<div id="look-for-columns-that-are-bijections-of-one-another" class="section level2">
<h2><span class="header-section-number">3.3</span> Look for columns that are bijections of one another</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bijections_cols &lt;-<span class="st"> </span><span class="kw">which_are_bijection</span>(messy_adult)</code></pre></div>
<pre><code># &quot;which_are_bijection: it took me 0.21s to identify 3 column(s) to drop.&quot;</code></pre>
To control this, let's have a look to the concerned columns:
<table class="table table-striped table-hover" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
constant
</th>
<th style="text-align:left;">
date3
</th>
<th style="text-align:left;">
date4
</th>
<th style="text-align:right;">
num1
</th>
<th style="text-align:right;">
num3
</th>
<th style="text-align:left;">
education
</th>
<th style="text-align:right;">
education_num
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2017-03-24
</td>
<td style="text-align:left;">
2017-03-26
</td>
<td style="text-align:right;">
1.9309
</td>
<td style="text-align:right;">
1.9309
</td>
<td style="text-align:left;">
Bachelors
</td>
<td style="text-align:right;">
13
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2017-02-01
</td>
<td style="text-align:left;">
2017-02-03
</td>
<td style="text-align:right;">
-0.4273
</td>
<td style="text-align:right;">
-0.4273
</td>
<td style="text-align:left;">
Bachelors
</td>
<td style="text-align:right;">
13
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2017-09-18
</td>
<td style="text-align:left;">
2017-09-20
</td>
<td style="text-align:right;">
0.6093
</td>
<td style="text-align:right;">
0.6093
</td>
<td style="text-align:left;">
HS-grad
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2017-06-25
</td>
<td style="text-align:left;">
2017-06-27
</td>
<td style="text-align:right;">
-0.5138
</td>
<td style="text-align:right;">
-0.5138
</td>
<td style="text-align:left;">
11th
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2017-01-26
</td>
<td style="text-align:left;">
2017-01-28
</td>
<td style="text-align:right;">
1.0563
</td>
<td style="text-align:right;">
1.0563
</td>
<td style="text-align:left;">
Bachelors
</td>
<td style="text-align:right;">
13
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2017-04-04
</td>
<td style="text-align:left;">
2017-04-06
</td>
<td style="text-align:right;">
-0.9377
</td>
<td style="text-align:right;">
-0.9377
</td>
<td style="text-align:left;">
Masters
</td>
<td style="text-align:right;">
14
</td>
</tr>
</tbody>
</table>
<p>Indeed:</p>
<ul>
<li><em>constant</em> was build constant, it contains only 1,</li>
<li><em>num1</em> and <em>num3</em> are equal,</li>
<li><em>date3</em> and <em>date4</em> are separated by 2 days: date4 doesn't contain any new information for a ML algorithm,</li>
<li><em>education</em> and <em>education_num</em> contains the same information one with a key index, the other one with the character corresponding. <code>which_are_bijection</code> keeps the character column.</li>
</ul>
</div>
<div id="filter-them-all" class="section level2">
<h2><span class="header-section-number">3.4</span> Filter them all</h2>
<p>To directly filter all of them:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ncols &lt;-<span class="st"> </span><span class="kw">ncol</span>(messy_adult)
messy_adult &lt;-<span class="st"> </span><span class="kw">fast_filter_variables</span>(messy_adult)
<span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;messy_adult now have &quot;</span>, <span class="kw">ncol</span>(messy_adult), <span class="st">&quot; columns; so &quot;</span>, ncols <span class="op">-</span><span class="st"> </span><span class="kw">ncol</span>(messy_adult), <span class="st">&quot; less than before.&quot;</span>))</code></pre></div>
<pre><code># &quot;fast_filter_variables: I check for constant columns.&quot;
# &quot;fast_filter_variables: I delete 1 constant column(s) in data_set.&quot;
# &quot;fast_filter_variables: I check for columns in double.&quot;
# &quot;fast_filter_variables: I delete 1 column(s) that are in double in data_set.&quot;
# &quot;fast_filter_variables: I check for columns that are bijections of another column.&quot;
# &quot;fast_filter_variables: I delete 2 column(s) that are bijections of another column in data_set.&quot;
# &quot;messy_adult now have 20 columns; so 4 less than before.&quot;</code></pre>
<p>4 useless columns have been deleted. Without those useless columns, your machine learning algorithm will at least be faster and maybe give better results.</p>
</div>
</div>
<div id="transform-functions" class="section level1">
<h1><span class="header-section-number">4</span> <em>Transform</em> functions</h1>
<p>Before sending this to a machine learning algorithm, a few transformations should be performed.</p>
<p>The idea with the functions presented here is to perform those transformations in a RAM efficient way.</p>
<div id="dates-differences" class="section level2">
<h2><span class="header-section-number">4.1</span> Dates differences</h2>
<p>Since no machine learning algorithm handle Dates, one needs to transform them or drop them. A way to transform dates is to perform differences between every date.</p>
<p>We can also add an analysis date to compare dates with the date your data is from. For example, if you have a birth-date you may want to compute age by performing today - birth-date.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">messy_adult &lt;-<span class="st"> </span><span class="kw">generate_date_diffs</span>(messy_adult, <span class="dt">cols =</span> <span class="st">&quot;auto&quot;</span>, <span class="dt">analysis_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2018-01-01&quot;</span>), <span class="dt">units =</span> <span class="st">&quot;days&quot;</span>)</code></pre></div>
<pre><code># &quot;num1&quot;          &quot;num2&quot;          &quot;mail&quot;          &quot;age&quot;          
# &quot;type_employer&quot; &quot;fnlwgt&quot;        &quot;education&quot;     &quot;marital&quot;      
# &quot;occupation&quot;    &quot;relationship&quot;  &quot;race&quot;          &quot;sex&quot;          
# &quot;capital_gain&quot;  &quot;capital_loss&quot;  &quot;hr_per_week&quot;   &quot;country&quot;      
# &quot;income&quot;       
# [1] &quot;generate_date_diffs: c(\&quot;num1\&quot;, \&quot;num2\&quot;, \&quot;mail\&quot;, \&quot;age\&quot;, \&quot;type_employer\&quot;, \&quot;fnlwgt\&quot;, \&quot;education\&quot;, \&quot;marital\&quot;, \&quot;occupation\&quot;, \&quot;relationship\&quot;, \&quot;race\&quot;, \&quot;sex\&quot;, \&quot;capital_gain\&quot;, \&quot;capital_loss\&quot;, \&quot;hr_per_week\&quot;, \&quot;country\&quot;, \&quot;income\&quot;) aren't columns of types date i do nothing for those variables.&quot;
# [1] &quot;generate_date_diffs: I will generate difference between dates.&quot;
# [1] &quot;generate_date_diffs: It took me 0.01s to create 6 column(s).&quot;</code></pre>
<table class="table table-striped table-hover" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
...
</th>
<th style="text-align:right;">
date1.Minus.date3
</th>
<th style="text-align:right;">
date1.Minus.analysis.date
</th>
<th style="text-align:right;">
date2.Minus.date3
</th>
<th style="text-align:right;">
date2.Minus.analysis.date
</th>
<th style="text-align:right;">
date3.Minus.analysis.date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
...
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
232.95833
</td>
<td style="text-align:right;">
-50
</td>
<td style="text-align:right;">
-282.9583
</td>
</tr>
<tr>
<td style="text-align:left;">
...
</td>
<td style="text-align:right;">
237
</td>
<td style="text-align:right;">
-96.95833
</td>
<td style="text-align:right;">
52.95833
</td>
<td style="text-align:right;">
-281
</td>
<td style="text-align:right;">
-333.9583
</td>
</tr>
<tr>
<td style="text-align:left;">
...
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
56.95833
</td>
<td style="text-align:right;">
-48
</td>
<td style="text-align:right;">
-104.9583
</td>
</tr>
<tr>
<td style="text-align:left;">
...
</td>
<td style="text-align:right;">
-170
</td>
<td style="text-align:right;">
-359.95833
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-189.9583
</td>
</tr>
<tr>
<td style="text-align:left;">
...
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
104.95833
</td>
<td style="text-align:right;">
-235
</td>
<td style="text-align:right;">
-339.9583
</td>
</tr>
<tr>
<td style="text-align:left;">
...
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
-166.95833
</td>
<td style="text-align:right;">
35.95833
</td>
<td style="text-align:right;">
-236
</td>
<td style="text-align:right;">
-271.9583
</td>
</tr>
</tbody>
</table>
</div>
<div id="transforming-dates-into-aggregates" class="section level2">
<h2><span class="header-section-number">4.2</span> Transforming dates into aggregates</h2>
<p>Another way to work around dates would be to aggregate them at some level. This time <code>drop</code> is set to <code>TRUE</code> in order to drop date columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">messy_adult &lt;-<span class="st"> </span><span class="kw">generate_factor_from_date</span>(messy_adult, <span class="dt">cols =</span> <span class="st">&quot;auto&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;quarter&quot;</span>, <span class="dt">drop =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code># &quot;num1&quot;                      &quot;num2&quot;                     
# &quot;mail&quot;                      &quot;age&quot;                      
# &quot;type_employer&quot;             &quot;fnlwgt&quot;                   
# &quot;education&quot;                 &quot;marital&quot;                  
# &quot;occupation&quot;                &quot;relationship&quot;             
# &quot;race&quot;                      &quot;sex&quot;                      
# &quot;capital_gain&quot;              &quot;capital_loss&quot;             
# &quot;hr_per_week&quot;               &quot;country&quot;                  
# &quot;income&quot;                    &quot;date1.Minus.date2&quot;        
# &quot;date1.Minus.date3&quot;         &quot;date1.Minus.analysis.date&quot;
# &quot;date2.Minus.date3&quot;         &quot;date2.Minus.analysis.date&quot;
# &quot;date3.Minus.analysis.date&quot;
# [1] &quot;generate_factor_from_date: c(\&quot;num1\&quot;, \&quot;num2\&quot;, \&quot;mail\&quot;, \&quot;age\&quot;, \&quot;type_employer\&quot;, \&quot;fnlwgt\&quot;, \&quot;education\&quot;, \&quot;marital\&quot;, \&quot;occupation\&quot;, \&quot;relationship\&quot;, \&quot;race\&quot;, \&quot;sex\&quot;, \&quot;capital_gain\&quot;, \&quot;capital_loss\&quot;, \&quot;hr_per_week\&quot;, \&quot;country\&quot;, \&quot;income\&quot;, \&quot;date1.Minus.date2\&quot;, \&quot;date1.Minus.date3\&quot;, \&quot;date1.Minus.analysis.date\&quot;, \&quot;date2.Minus.date3\&quot;, \&quot;date2.Minus.analysis.date\&quot;, \&quot;date3.Minus.analysis.date\&quot;) aren't columns of types date i do nothing for those variables.&quot;
# [1] &quot;generate_factor_from_date: I will create a factor column from each date column.&quot;
# [1] &quot;generate_factor_from_date: It took me 0.03s to transform 3 column(s).&quot;</code></pre>
<table class="table table-striped table-hover" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
...
</th>
<th style="text-align:left;">
date1.quarter
</th>
<th style="text-align:left;">
date2.quarter
</th>
<th style="text-align:left;">
date3.quarter
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
...
</td>
<td style="text-align:left;">
QNA
</td>
<td style="text-align:left;">
Q4
</td>
<td style="text-align:left;">
Q1
</td>
</tr>
<tr>
<td style="text-align:left;">
...
</td>
<td style="text-align:left;">
Q3
</td>
<td style="text-align:left;">
Q1
</td>
<td style="text-align:left;">
Q1
</td>
</tr>
<tr>
<td style="text-align:left;">
...
</td>
<td style="text-align:left;">
QNA
</td>
<td style="text-align:left;">
Q4
</td>
<td style="text-align:left;">
Q3
</td>
</tr>
<tr>
<td style="text-align:left;">
...
</td>
<td style="text-align:left;">
Q1
</td>
<td style="text-align:left;">
QNA
</td>
<td style="text-align:left;">
Q2
</td>
</tr>
<tr>
<td style="text-align:left;">
...
</td>
<td style="text-align:left;">
QNA
</td>
<td style="text-align:left;">
Q2
</td>
<td style="text-align:left;">
Q1
</td>
</tr>
<tr>
<td style="text-align:left;">
...
</td>
<td style="text-align:left;">
Q3
</td>
<td style="text-align:left;">
Q2
</td>
<td style="text-align:left;">
Q2
</td>
</tr>
</tbody>
</table>
</div>
<div id="generate-features-from-character-columns" class="section level2">
<h2><span class="header-section-number">4.3</span> Generate features from character columns</h2>
<p>Character columns are not handled by any machine learning algorithm, one should transform them. Function <code>generate_from_character</code> build some new feature from them, and then drop them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">messy_adult &lt;-<span class="st"> </span><span class="kw">generate_from_character</span>(messy_adult, <span class="dt">cols =</span> <span class="st">&quot;auto&quot;</span>, <span class="dt">drop =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code># &quot;num1&quot;                      &quot;num2&quot;                     
# &quot;age&quot;                       &quot;type_employer&quot;            
# &quot;fnlwgt&quot;                    &quot;education&quot;                
# &quot;marital&quot;                   &quot;occupation&quot;               
# &quot;relationship&quot;              &quot;race&quot;                     
# &quot;sex&quot;                       &quot;capital_gain&quot;             
# &quot;capital_loss&quot;              &quot;hr_per_week&quot;              
# &quot;country&quot;                   &quot;income&quot;                   
# &quot;date1.Minus.date2&quot;         &quot;date1.Minus.date3&quot;        
# &quot;date1.Minus.analysis.date&quot; &quot;date2.Minus.date3&quot;        
# &quot;date2.Minus.analysis.date&quot; &quot;date3.Minus.analysis.date&quot;
# &quot;date1.quarter&quot;             &quot;date2.quarter&quot;            
# &quot;date3.quarter&quot;            
# [1] &quot;generate_from_character: c(\&quot;num1\&quot;, \&quot;num2\&quot;, \&quot;age\&quot;, \&quot;type_employer\&quot;, \&quot;fnlwgt\&quot;, \&quot;education\&quot;, \&quot;marital\&quot;, \&quot;occupation\&quot;, \&quot;relationship\&quot;, \&quot;race\&quot;, \&quot;sex\&quot;, \&quot;capital_gain\&quot;, \&quot;capital_loss\&quot;, \&quot;hr_per_week\&quot;, \&quot;country\&quot;, \&quot;income\&quot;, \&quot;date1.Minus.date2\&quot;, \&quot;date1.Minus.date3\&quot;, \&quot;date1.Minus.analysis.date\&quot;, \&quot;date2.Minus.date3\&quot;, \&quot;date2.Minus.analysis.date\&quot;, \&quot;date3.Minus.analysis.date\&quot;, \&quot;date1.quarter\&quot;, \&quot;date2.quarter\&quot;, \&quot;date3.quarter\&quot;) aren't columns of types character i do nothing for those variables.&quot;
# [1] &quot;generate_from_character: it took me: 0.02s to transform 1 character columns into, 3 new columns.&quot;</code></pre>
<table class="table table-striped table-hover" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
mail.notnull
</th>
<th style="text-align:right;">
mail.num
</th>
<th style="text-align:right;">
mail.order
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="aggregate-according-to-a-key" class="section level2">
<h2><span class="header-section-number">4.4</span> Aggregate according to a key</h2>
<p>To model something by country; one would want to to compute an aggregation of this table in order to have one line per country.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">agg_adult &lt;-<span class="st"> </span><span class="kw">aggregate_by_key</span>(messy_adult, <span class="dt">key =</span> <span class="st">&quot;country&quot;</span>)</code></pre></div>
<pre><code># &quot;aggregate_by_key: I start to aggregate&quot;
# &quot;aggregate_by_key: 139 columns have been constructed. It took 0.27 seconds. &quot;</code></pre>
<table class="table table-striped table-hover" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
country
</th>
<th style="text-align:right;">
max.age
</th>
<th style="text-align:right;">
type_employer.Without-pay
</th>
<th style="text-align:right;">
education.Assoc-acdm
</th>
<th style="text-align:right;">
marital.Married-AF-spouse
</th>
<th style="text-align:left;">
...
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
?
</td>
<td style="text-align:right;">
90
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:left;">
Cambodia
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:left;">
Canada
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:left;">
China
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:left;">
Columbia
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:left;">
Cuba
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
...
</td>
</tr>
</tbody>
</table>
<p>Every time you have more than one line per individual this function would be pretty cool.</p>
</div>
<div id="rounding" class="section level2">
<h2><span class="header-section-number">4.5</span> Rounding</h2>
<p>One might want to round numeric variables in order to save some RAM, or for algorithmic reasons:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">messy_adult &lt;-<span class="st"> </span><span class="kw">fast_round</span>(messy_adult, <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code># &quot;type_employer&quot; &quot;education&quot;     &quot;marital&quot;       &quot;occupation&quot;   
# &quot;relationship&quot;  &quot;race&quot;          &quot;sex&quot;           &quot;country&quot;      
# &quot;income&quot;        &quot;date1.quarter&quot; &quot;date2.quarter&quot; &quot;date3.quarter&quot;
# &quot;mail.notnull&quot; 
# [1] &quot;fast_round: c(\&quot;type_employer\&quot;, \&quot;education\&quot;, \&quot;marital\&quot;, \&quot;occupation\&quot;, \&quot;relationship\&quot;, \&quot;race\&quot;, \&quot;sex\&quot;, \&quot;country\&quot;, \&quot;income\&quot;, \&quot;date1.quarter\&quot;, \&quot;date2.quarter\&quot;, \&quot;date3.quarter\&quot;, \&quot;mail.notnull\&quot;) aren't columns of types numeric or integer i do nothing for those variables.&quot;</code></pre>
<table class="table table-striped table-hover" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
num1
</th>
<th style="text-align:right;">
num2
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
type_employer
</th>
<th style="text-align:right;">
fnlwgt
</th>
<th style="text-align:left;">
education
</th>
<th style="text-align:left;">
...
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
Private
</td>
<td style="text-align:right;">
173960
</td>
<td style="text-align:left;">
Bachelors
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.60
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:left;">
Private
</td>
<td style="text-align:right;">
371987
</td>
<td style="text-align:left;">
Bachelors
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:left;">
Private
</td>
<td style="text-align:right;">
94936
</td>
<td style="text-align:left;">
Assoc-acdm
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
2.83
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:left;">
Private
</td>
<td style="text-align:right;">
166481
</td>
<td style="text-align:left;">
7th-8th
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.87
</td>
<td style="text-align:right;">
-0.39
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:left;">
Self-emp-inc
</td>
<td style="text-align:right;">
197332
</td>
<td style="text-align:left;">
Some-college
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:right;">
1.20
</td>
<td style="text-align:right;">
-0.74
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:left;">
Private
</td>
<td style="text-align:right;">
244147
</td>
<td style="text-align:left;">
HS-grad
</td>
<td style="text-align:left;">
...
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="handling-nas-values" class="section level1">
<h1><span class="header-section-number">5</span> Handling NAs values</h1>
<p>Then, let's handle NAs, <code>fast_handle_na</code> allows you to choose how you fill NAs. By default, numeric cols are filled with 0, boolean cols are filled with FALSE and character cols are filled with &quot;&quot;.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">messy_adult &lt;-<span class="st"> </span><span class="kw">fast_handle_na</span>(messy_adult)</code></pre></div>
<pre><code>#    num1  num2 age type_employer   ...       country income date1.Minus.date2
# 1: 0.59 -0.50  60       Private   ... United-States  &lt;=50K           -173.96
# 2: 0.00 -0.60  25       Private   ... United-States  &lt;=50K             23.04
# 3: 0.00  0.48  26       Private   ... United-States  &lt;=50K            -73.96
# 4: 0.02  2.83  28       Private   ...   Puerto-Rico  &lt;=50K           -234.96
#    date1.Minus.date3 date1.Minus.analysis.date date2.Minus.date3
# 1:                65                   -293.96            238.96
# 2:              -117                   -334.96           -140.04
# 3:               -33                   -138.96             40.96
# 4:              -228                   -336.96              6.96
#    date2.Minus.analysis.date date3.Minus.analysis.date date1.quarter
# 1:                      -120                   -358.96            Q1
# 2:                      -358                   -217.96            Q1
# 3:                       -65                   -105.96            Q3
# 4:                      -102                   -108.96            Q1
#    date2.quarter date3.quarter mail.notnull mail.num mail.order
# 1:            Q3            Q1         TRUE      200          1
# 2:            Q1            Q2         TRUE      200          1
# 3:            Q4            Q3         TRUE      200          1
# 4:            Q3            Q3         TRUE      200          1</code></pre>
<p>If you want to put some specific values (constants, or even a function for example mean of values) you should go check <code>fast_handle_na</code> documentation.</p>
</div>
<div id="shape-functions" class="section level1">
<h1><span class="header-section-number">6</span> Shape functions</h1>
<p>There are two types of machine learning algorithm in R: those which accept data.table and factor, those which only accept numeric matrix.</p>
<p>Transforming a data set into something acceptable for a machine learning algorithm could be tricky.</p>
<p>The <code>shape_set</code> function do it for you, you just have to choose if you want a <em>data.table</em> or a <em>numerical_matrix</em>.</p>
<p>First with <em>data.table</em>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">clean_adult &lt;-<span class="st"> </span><span class="kw">shape_set</span>(<span class="kw">copy</span>(messy_adult), <span class="dt">final_form =</span> <span class="st">&quot;data.table&quot;</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
<span class="kw">print</span>(<span class="kw">table</span>(<span class="kw">sapply</span>(clean_adult, class)))</code></pre></div>
<pre><code># 
#  factor integer numeric 
#      12       1      15</code></pre>
<p>As one can see, there only are, numeric and factors.</p>
<p>Now with <em>numerical_matrix</em>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">clean_adult &lt;-<span class="st"> </span><span class="kw">shape_set</span>(<span class="kw">copy</span>(messy_adult), <span class="dt">final_form =</span> <span class="st">&quot;numerical_matrix&quot;</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</code></pre></div>
<table class="table table-striped table-hover" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
num1
</th>
<th style="text-align:right;">
num2
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:right;">
type_employer?
</th>
<th style="text-align:right;">
type_employerFederal-gov
</th>
<th style="text-align:right;">
type_employerLocal-gov
</th>
<th style="text-align:left;">
...
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.60
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
2.83
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.87
</td>
<td style="text-align:right;">
-0.39
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:right;">
1.20
</td>
<td style="text-align:right;">
-0.74
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
...
</td>
</tr>
</tbody>
</table>
<p>As one can see, with <code>final_form = &quot;numerical_matrix&quot;</code> every character and factor have been binarized.</p>
</div>
<div id="full-pipeline" class="section level1">
<h1><span class="header-section-number">7</span> Full pipeline</h1>
<p>Doing it all with one function is possible:</p>
<p>To do that we will reload the ugly data set and perform aggregation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;messy_adult&quot;</span>)
agg_adult &lt;-<span class="st"> </span><span class="kw">prepare_set</span>(messy_adult, <span class="dt">final_form =</span> <span class="st">&quot;data.table&quot;</span>, <span class="dt">key =</span> <span class="st">&quot;country&quot;</span>, <span class="dt">analysis_date =</span> <span class="kw">Sys.Date</span>(), <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code># &quot;prepare_set: step one: correcting mistakes.&quot;
# &quot;fast_filter_variables: I check for constant columns.&quot;
# &quot;fast_filter_variables: I delete 1 constant column(s) in data_set.&quot;
# &quot;fast_filter_variables: I check for columns in double.&quot;
# &quot;fast_filter_variables: I check for columns that are bijections of another column.&quot;
# &quot;fast_filter_variables: I delete 3 column(s) that are bijections of another column in data_set.&quot;
#  [1] &quot;date1&quot;        &quot;date2&quot;        &quot;date4&quot;        &quot;num2&quot;         &quot;num3&quot;        
#  [6] &quot;age&quot;          &quot;fnlwgt&quot;       &quot;capital_gain&quot; &quot;capital_loss&quot; &quot;hr_per_week&quot; 
# &quot;un_factor: c(\&quot;date1\&quot;, \&quot;date2\&quot;, \&quot;date4\&quot;, \&quot;num2\&quot;, \&quot;num3\&quot;, \&quot;age\&quot;, \&quot;fnlwgt\&quot;, \&quot;capital_gain\&quot;, \&quot;capital_loss\&quot;, \&quot;hr_per_week\&quot;) aren't columns of types factor i do nothing for those variables.&quot;
# &quot;un_factor: I will identify variable that are factor but shouldn't be.&quot;
# &quot;un_factor: I unfactor mail.&quot;
# &quot;un_factor: It took me 0.02s to unfactor 1 column(s).&quot;
# &quot;find_and_transform_numerics: It took me 0s to identify 2 numerics column(s), i will set them as numerics&quot;
# &quot;set_col_as_numeric: I will set some columns as numeric&quot;
# &quot;set_col_as_numeric: I am doing the column num2.&quot;
# &quot;set_col_as_numeric: 0 NA have been created due to transformation to numeric.&quot;
# &quot;set_col_as_numeric: I am doing the column num3.&quot;
# &quot;set_col_as_numeric: 0 NA have been created due to transformation to numeric.&quot;
# &quot;find_and_transform_numerics: It took me 0.03s to transform 2 column(s) to a numeric format.&quot;
# &quot;find_and_transform_dates: It took me 0.45s to identify formats&quot;
# &quot;find_and_transform_dates: It took me 0.05s to transform 3 columns to a Date format.&quot;
# &quot;prepare_set: step two: transforming data_set.&quot;
#  [1] &quot;num2&quot;          &quot;mail&quot;          &quot;num3&quot;          &quot;age&quot;          
#  [5] &quot;type_employer&quot; &quot;fnlwgt&quot;        &quot;education&quot;     &quot;marital&quot;      
#  [9] &quot;occupation&quot;    &quot;relationship&quot;  &quot;race&quot;          &quot;sex&quot;          
# [13] &quot;capital_gain&quot;  &quot;capital_loss&quot;  &quot;hr_per_week&quot;   &quot;country&quot;      
# [17] &quot;income&quot;       
# &quot;prepare_set: c(\&quot;num2\&quot;, \&quot;mail\&quot;, \&quot;num3\&quot;, \&quot;age\&quot;, \&quot;type_employer\&quot;, \&quot;fnlwgt\&quot;, \&quot;education\&quot;, \&quot;marital\&quot;, \&quot;occupation\&quot;, \&quot;relationship\&quot;, \&quot;race\&quot;, \&quot;sex\&quot;, \&quot;capital_gain\&quot;, \&quot;capital_loss\&quot;, \&quot;hr_per_week\&quot;, \&quot;country\&quot;, \&quot;income\&quot;) aren't columns of types date i do nothing for those variables.&quot;
# &quot;generate_date_diffs: I will generate difference between dates.&quot;
# &quot;generate_date_diffs: It took me 0s to create 6 column(s).&quot;
# &quot;generate_factor_from_date: I will create a factor column from each date column.&quot;
# &quot;generate_factor_from_date: It took me 0.34s to transform 3 column(s).&quot;
#  [1] &quot;date1&quot;                     &quot;date2&quot;                    
#  [3] &quot;date4&quot;                     &quot;num2&quot;                     
#  [5] &quot;num3&quot;                      &quot;age&quot;                      
#  [7] &quot;type_employer&quot;             &quot;fnlwgt&quot;                   
#  [9] &quot;education&quot;                 &quot;marital&quot;                  
# [11] &quot;occupation&quot;                &quot;relationship&quot;             
# [13] &quot;race&quot;                      &quot;sex&quot;                      
# [15] &quot;capital_gain&quot;              &quot;capital_loss&quot;             
# [17] &quot;hr_per_week&quot;               &quot;country&quot;                  
# [19] &quot;income&quot;                    &quot;date1.Minus.date2&quot;        
# [21] &quot;date1.Minus.date4&quot;         &quot;date1.Minus.analysis.date&quot;
# [23] &quot;date2.Minus.date4&quot;         &quot;date2.Minus.analysis.date&quot;
# [25] &quot;date4.Minus.analysis.date&quot;
# &quot;prepare_set: c(\&quot;date1\&quot;, \&quot;date2\&quot;, \&quot;date4\&quot;, \&quot;num2\&quot;, \&quot;num3\&quot;, \&quot;age\&quot;, \&quot;type_employer\&quot;, \&quot;fnlwgt\&quot;, \&quot;education\&quot;, \&quot;marital\&quot;, \&quot;occupation\&quot;, \&quot;relationship\&quot;, \&quot;race\&quot;, \&quot;sex\&quot;, \&quot;capital_gain\&quot;, \&quot;capital_loss\&quot;, \&quot;hr_per_week\&quot;, \&quot;country\&quot;, \&quot;income\&quot;, \&quot;date1.Minus.date2\&quot;, \&quot;date1.Minus.date4\&quot;, \&quot;date1.Minus.analysis.date\&quot;, \&quot;date2.Minus.date4\&quot;, \&quot;date2.Minus.analysis.date\&quot;, \&quot;date4.Minus.analysis.date\&quot;) aren't columns of types character i do nothing for those variables.&quot;
# &quot;generate_from_character: it took me: 0s to transform 1 character columns into, 3 new columns.&quot;
# &quot;aggregate_by_key: I start to aggregate&quot;
# &quot;aggregate_by_key: 164 columns have been constructed. It took 0.25 seconds. &quot;
# &quot;prepare_set: step three: filtering data_set.&quot;
# &quot;fast_filter_variables: I check for constant columns.&quot;
# &quot;fast_filter_variables: I delete 2 constant column(s) in result.&quot;
# &quot;fast_filter_variables: I check for columns in double.&quot;
# &quot;fast_filter_variables: I delete 1 column(s) that are in double in result.&quot;
# &quot;fast_filter_variables: I check for columns that are bijections of another column.&quot;
# &quot;fast_filter_variables: I delete 35 column(s) that are bijections of another column in result.&quot;
# &quot;country&quot;
# &quot;fast_round: country aren't columns of types numeric or integer i do nothing for those variables.&quot;
# &quot;prepare_set: step four: handling NA.&quot;
# &quot;prepare_set: step five: shaping result.&quot;
# &quot;set_col_as_factor: I will set some columns to factor.&quot;
# &quot;set_col_as_factor: it took me: 0s to transform 0 column(s) to factor.&quot;
# &quot;shape_set: Transforming numerical variables into factors when length(unique(col)) &lt;= 10.&quot;
# &quot;shape_set: Previous distribution of column types:&quot;
# col_class_init
#  factor numeric 
#       1     125 
# &quot;shape_set: Current distribution of column types:&quot;
# col_class_end
#  factor numeric 
#      37      89</code></pre>
<p>As one can see, every previously steps have been done.</p>
<p>Let's have a look to the result</p>
<pre><code># &quot;126 columns have been built; for 42 countries.&quot;</code></pre>
<table class="table table-striped table-hover" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
country
</th>
<th style="text-align:right;">
nbr_lines
</th>
<th style="text-align:left;">
mean.num2
</th>
<th style="text-align:left;">
sd.num2
</th>
<th style="text-align:left;">
mean.num3
</th>
<th style="text-align:left;">
sd.num3
</th>
<th style="text-align:left;">
min.age
</th>
<th style="text-align:left;">
...
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
?
</td>
<td style="text-align:right;">
529
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:left;">
Cambodia
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
0.08
</td>
<td style="text-align:left;">
0.78
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
25
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:left;">
Canada
</td>
<td style="text-align:right;">
108
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:left;">
China
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:left;">
Columbia
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
...
</td>
</tr>
<tr>
<td style="text-align:left;">
Cuba
</td>
<td style="text-align:right;">
88
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
...
</td>
</tr>
</tbody>
</table>
</div>
<div id="description" class="section level1">
<h1><span class="header-section-number">8</span> Description</h1>
<p>Finally, to generate a description file from this data set, function <code>description</code> is available.</p>
<p>It will describe, the set and its variables. Here we put <code>level=0</code> to have some global descriptions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">description</span>(agg_adult, <span class="dt">level =</span> <span class="dv">0</span>)</code></pre></div>
<pre><code># &quot;data_set is a data.table-data.frame&quot;
# [1] &quot;data_set contains 42 rows and 126 cols.&quot;
# [1] &quot;Columns are of the following classes:&quot;
# 
#  factor numeric 
#      37      89</code></pre>
</div>
<div id="conclusion" class="section level1">
<h1><span class="header-section-number">9</span> Conclusion</h1>
<p>We presented some of the functions of <em>dataPreparation</em> package. There are a few more available, plus they have some parameters to make their use easier. So if you liked it, please go check the package documentation (by installing it or on <a href="https://CRAN.R-project.org/package=dataPreparation/dataPreparation.pdf">CRAN</a>)</p>
<p>We hope that this package is helpful, that it helped you prepare your data in a faster way.</p>
<p>If you would like to give us some feedback, report some issues, add some features to this package, please tell us on <a href="https://github.com/ELToulemonde/dataPreparation/issues">GitHub</a>. Also if you want to contribute, please don't hesitate to contact us.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
